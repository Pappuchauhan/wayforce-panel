import{r as i,S as C,l as M}from"./index-tXNXoeRs.js";import{u as P}from"./index.esm-MInxdUYi.js";import{S as u}from"./SettingServices-U-Kr69tQ.js";import{a as p,n as f}from"./toast-1_nHReMg.js";import{u as A}from"./useFilter-8scIczCo.js";import{u as T}from"./useDispatch-FcLvS5kM.js";const J=U=>{const w=T(),g=i.useRef(null),S=i.useRef(null),d=i.useRef(null),{setIsUpdate:b}=i.useContext(C),[_,R]=i.useState(!0),[x,a]=i.useState(!1),{register:I,handleSubmit:D,setValue:n,formState:{errors:E}}=P();A();const F=async t=>{var o,e;t.preventDefault();try{a(!0);const s=S.current.value,c=d.current.value,h=g.current.files[0],r=new FileReader;if(h&&(r.onload=()=>{const m=r.result.split(`
`);for(let l=1;l<m.length;l++){const y=m[l];if(y.trim()==="")continue;const V=y.split(",")}},r.readAsText(h)),c!==""){const v=c.split(",");for(let m=0;m<v.length;m++);}f("Message sent to all users"),a(!1)}catch(s){p(((e=(o=s==null?void 0:s.response)==null?void 0:o.data)==null?void 0:e.message)||(s==null?void 0:s.message)),a(!1)}},G=async t=>{var o,e;try{a(!0);const s={name:"globalSetting",setting:{commission:t.commission,shop_name:t.shop_name,address:t.address,company_name:t.company_name,vat_number:t.vat_number,post_code:t.post_code,contact:t.contact,email:t.email,website:t.website}};if(_){const c=await u.addGlobalSetting(s);b(!0),a(!1),f(c.message)}else{const c=await u.updateGlobalSetting(s);b(!0),a(!1),w(M("globalSetting")),f(c.message)}}catch(s){p(((e=(o=s==null?void 0:s.response)==null?void 0:o.data)==null?void 0:e.message)||(s==null?void 0:s.message)),a(!1)}};return i.useEffect(()=>{(async()=>{var t,o;try{const e=await u.getGlobalSetting();e&&(R(!1),n("shop_name",e.shop_name),n("address",e.address),n("company_name",e.company_name),n("vat_number",e.vat_number),n("post_code",e.post_code),n("contact",e.contact),n("email",e.email),n("website",e.website),n("commission",e.commission))}catch(e){p(((o=(t=e==null?void 0:e.response)==null?void 0:t.data)==null?void 0:o.message)||(e==null?void 0:e.message))}})()},[]),{errors:E,register:I,isSave:_,isSubmitting:x,onSubmit:G,onSubmitMessage:F,handleSubmit:D,fileInputRef:g,descInputRef:S,textInputRef:d}};export{J as u};
