import{d as q}from"./index-cxPaO_Qc.js";import{r as d,A as z,S as G,e as H}from"./index-bXf7bkfr.js";import{u as J,C as Q}from"./index.esm-3tbPwPzp.js";import{U as m}from"./UserServices-_gsJi_DW.js";import{n as C,a as x}from"./toast-J_gpu8Z1.js";const ae=i=>{const{state:U}=d.useContext(z),{adminInfo:k}=U,{isDrawerOpen:u,closeDrawer:l,setIsUpdate:f,lang:b}=d.useContext(G),[Y,v]=d.useState(q().subtract(15,"year").format("YYYY-MM-DD")),[D,y]=d.useState(b||"en"),[L,S]=d.useState({}),[A,c]=d.useState(!1),[I,E]=d.useState(""),[h,j]=d.useState(""),[w,F]=d.useState("");H();const{register:M,control:T,handleSubmit:N,setValue:a,clearErrors:g,formState:{errors:O},getValues:$}=J(),K=async t=>{var r,e;try{c(!0);const n=new Date(t.dob);t.age=P(n),console.log(t.speakingLanguages);const s=new FormData;if(s.append("profileImage",I),s.append("panImage",h),s.append("aadharImage",w),t.speakingLanguages.forEach((o,p)=>{s.append(`speakingLanguage[${p}]`,o)}),s.append("address[addressLine1]",t.addressLine1),s.append("address[addressLine2]",t.addressLine2),s.append("address[block]",t.block),s.append("address[pinCode]",t.pinCode),s.append("address[state]",t.state),s.append("address[city]",t.city),s.append("address[country]",t.country),s.append("serviceLocation[address]",t.slAddress),Object.entries(t).forEach(([o,p])=>{(o!="speakingLanguages"||o!="speakingLanguage"||o!="address"||o!="address")&&(p==null?s.append(o,0):s.append(o,p))}),console.log(s),i){const o=await m.updateUser(i,s);f(!0),c(!1),C(o.message),l()}else{const o=await m.addUser(s);f(!0),c(!1),C(o.message),l()}}catch(n){x(n?(e=(r=n==null?void 0:n.response)==null?void 0:r.data)==null?void 0:e.message:n==null?void 0:n.message),c(!1),l()}},V=async()=>{var t,r;try{const e=await m.getUserById(i);if(e){S(e),a("aadharNumber",e.data.aadharNumber),a("age",e.data.age),a("bio",e.data.bio),a("category",e.data.category);let n=e.data.dob;e.data.dob!=""&&(n=new Date(e.data.dob).toISOString().split("T")[0]),console.log(e.data.speakingLanguage),a("dob",n),a("email",e.data.email),a("experience",e.data.experience),a("gender",e.data.gender),a("jobType",e.data.jobType),a("maxSalary",e.data.maxSalary),a("minSalary",e.data.minSalary),a("mobile",e.data.mobile),a("name",e.data.name),a("panCardNumber",e.data.panCardNumber),a("serviceLocation",e.data.serviceLocation),a("spkLanguage",e.data.speakingLanguage),a("userType",e.data.userType),a("status",e.data.status),a("profileImage",e.data.profileImage),a("panImage",e.data.panImage),a("aadharImage",e.data.aadharImage),a("wallet",e.data.wallet),a("isKyc",e.data.isKyc),a("addressLine1",e.data.address.addressLine1),a("addressLine2",e.data.address.addressLine2),a("block",e.data.address.block),a("pinCode",e.data.address.pinCode),a("state",e.data.address.state),a("city",e.data.address.city),a("country",e.data.address.country),a("slAddress",e.data.serviceLocation.address),a("lati",e.data.serviceLocation.lati),a("longi",e.data.serviceLocation.longi)}}catch(e){x(e?(r=(t=e==null?void 0:e.response)==null?void 0:t.data)==null?void 0:r.message:e==null?void 0:e.message)}},B=t=>{y(t),Object.keys(L).length>0&&a("name",L.name[t||"en"])};d.useEffect(()=>{if(!u){S({}),a("name"),a("price"),a("status"),g("name"),g("price"),g("status"),y(b),a("language",D);return}i&&(console.log(i),V())},[i,a,u,k.email,g]);function P(t){const r=new Date,e=new Date(t);let n=r.getFullYear()-e.getFullYear();const s=r.getMonth()-e.getMonth();return(s<0||s===0&&r.getDate()<e.getDate())&&n--,n}function R(t){const r=new Date(t);return`${("0"+r.getDate()).slice(-2)}-${("0"+(r.getMonth()+1)).slice(-2)}-${r.getFullYear()}`}return{register:M,handleSubmit:N,onSubmit:K,language:D,errors:O,isSubmitting:A,handleSelectLanguage:B,selectedDate:Y,setSelectedDate:v,userImage:I,setUserImage:E,panImage:h,setPanImage:j,aadharImage:w,setAadharImage:F,Controller:Q,control:T,formattedDate:R,getValues:$,setValue:a}};export{ae as u};
